<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to causalQual â€¢ causalQual</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to causalQual">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">causalQual</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/causalQual-short-tutorial.html">Short tutorial</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/riccardo-df/causalQual" class="external-link">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to causalQual</h1>
                        <h4 data-toc-skip class="author">Riccardo Di
Francesco</h4>
            
      

      <div class="hidden name"><code>causalQual-short-tutorial.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This tutorial provides an overview of the core functions in the
<code>causalQual</code> package, which facilitates causal inference with
qualitative outcomes under four widely used research designs:</p>
<ul>
<li>
<code><a href="../reference/causalQual_soo.html">causalQual_soo()</a></code> for selection-on-observables
designs</li>
<li>
<code><a href="../reference/causalQual_iv.html">causalQual_iv()</a></code> for instrumental variables designs</li>
<li>
<code><a href="../reference/causalQual_rd.html">causalQual_rd()</a></code> for regression discontinuity
designs</li>
<li>
<code><a href="../reference/causalQual_did.html">causalQual_did()</a></code> for difference-in-differences
designs</li>
</ul>
<p>Each function enables the estimation of well-defined and
interpretable causal estimands while preserving the identification
assumptions specific to each research design.</p>
</div>
<div class="section level2">
<h2 id="notation">Notation<a class="anchor" aria-label="anchor" href="#notation"></a>
</h2>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mo>âˆˆ</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>M</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">Y_i \in \{ 1, 2, \dots, M \}</annotation></semantics></math>
denotes the outcome of interest, which can take one of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
qualitative categories. These categories may exhibit a natural ordering
but lack a cardinal scale, making arithmetic operations such as
averaging or differencing ill-defined.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>i</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">Y_{is}</annotation></semantics></math>
denote the outcome of interest at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>âˆˆ</mo><mo stretchy="false" form="prefix">{</mo><mi>t</mi><mo>âˆ’</mo><mn>1</mn><mo>,</mo><mi>t</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">s \in \{ t-1, t \}</annotation></semantics></math>,
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t-1</annotation></semantics></math>
denoting the pre-treatment period and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
denoting the post-treatment period.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>i</mi></msub><mo>âˆˆ</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">D_i \in \{0 , 1\}</annotation></semantics></math>
is a binary treatment indicator.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>X</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>âŠ¤</mi></msup><mo>âˆˆ</mo><mi>ğ’³</mi></mrow><annotation encoding="application/x-tex">X_i = (X_{i1}, \dots, X_{ik})^\top \in \mathcal{X}</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>Ã—</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k \times 1</annotation></semantics></math>
vector of pre-treatment covariates.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>i</mi></msub><mo>âˆˆ</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">Z_i \in \{ 0, 1 \}</annotation></semantics></math>
is a binary instrument.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub><mo>âˆˆ</mo><mo stretchy="false" form="prefix">{</mo><mi>a</mi><mi>t</mi><mo>,</mo><mi>n</mi><mi>t</mi><mo>,</mo><mi>c</mi><mi>o</mi><mo>,</mo><mi>d</mi><mi>e</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">T_i \in \{ at, nt, co, de \}</annotation></semantics></math>
denotes a unitâ€™s compliance type (always-taker, never-taker, complier,
defier).</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.167em"></mspace><mi>d</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">Y_i (d), \, d = 0, 1</annotation></semantics></math>
are the potential outcomes as a function of treatment status.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo>,</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.167em"></mspace><mi>d</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mi>z</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">Y_i (d, z), \, d = 0, 1, z = 0, 1</annotation></semantics></math>
are the potential outcomes as a function of treatment status and
instrument assignment.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.167em"></mspace><mi>z</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">D_i (z), \, z = 0, 1</annotation></semantics></math>
are the potential treatments as a function of instrument
assignment.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>m</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo>,</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mi>m</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>D</mi><mi>i</mi></msub><mo>=</mo><mi>d</mi><mo>,</mo><msub><mi>X</mi><mi>i</mi></msub><mo>=</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_m (d, x) := P ( Y_i = m | D_i = d, X_i = x )</annotation></semantics></math>
denotes the conditional probability of observing outcome category
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
given treatment status
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>i</mi></msub><mo>=</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">D_i = d</annotation></semantics></math>
and covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">X_i = x</annotation></semantics></math>.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï€</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>D</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>i</mi></msub><mo>=</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi (x) := P ( D_i = 1 | X_i = x )</annotation></semantics></math>
represents the propensity score.</li>
</ul>
</div>
<div class="section level2">
<h2 id="selection-on-observables">Selection-on-Observables<a class="anchor" aria-label="anchor" href="#selection-on-observables"></a>
</h2>
<p>Selection-on-observables research designs are used to identify causal
effects when units are observed at some point in time, some receive
treatment, and we have data on pre-treatment characteristics and
post-treatment outcomes. This approach is based on the following
assumptions:</p>
<ul>
<li>
<strong>Assumption 1</strong> (<em>Unconfoundedness</em>):
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>âŠ¥</mi><msub><mi>D</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">Y_i(1), Y_i(0) âŠ¥ D_i | X_i</annotation></semantics></math>.</li>
<li>
<strong>Assumption 2</strong> (<em>Common support</em>):
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>Ï€</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 &lt; \pi(X_i) &lt; 1</annotation></semantics></math>.</li>
</ul>
<p>Assumption 1 states that, after conditioning on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub><annotation encoding="application/x-tex">X_i</annotation></semantics></math>,
treatment assignment is as good as random, meaning that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub><annotation encoding="application/x-tex">X_i</annotation></semantics></math>
fully accounts for selection into treatment. Assumption 2 mandates that
for every value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub><annotation encoding="application/x-tex">X_i</annotation></semantics></math>
there are both treated and untreated units, preventing situations where
no valid counterfactual exists.</p>
<p>Together, these assumptions enable the identification of the
Probability of Shift (PS), defined as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î´</mi><mi>m</mi></msub><mo>:=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> \delta_m := P ( Y_i (1) = m ) - P ( Y_i (0) = m ). </annotation></semantics></math>
PS characterizes how treatment affects the probability distribution over
outcome category
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>.
For instance,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î´</mi><mi>m</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\delta_m &gt; 0</annotation></semantics></math>
indicates that the treatment increases the likelihood of observing
outcome category
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>,
while
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î´</mi><mi>m</mi></msub><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\delta_m &lt; 0</annotation></semantics></math>
implies a decrease in the probability mass assigned to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
caused by the treatment. By construction,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></msubsup><msub><mi>Î´</mi><mi>m</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum_{m = 1}^M \delta_m = 0</annotation></semantics></math>,
reflecting the intuitive trade-off that an increase in the probability
of some outcome categories must be offset by a decrease in others.</p>
<p>For illustration, we generate a synthetic data set using the
<code>generate_qualitative_data_soo</code> function. Users can modify
the parameters to generate data sets with different sample sizes,
treatment assignment mechanisms (randomized vs.Â observational), and
outcome types (multinomial or ordered).</p>
<ul>
<li>Setting <code>outcome_type = "multinomial"</code> generates a
multinomial categorical outcome (e.g., brand choices, employment
status).</li>
<li>Setting <code>outcome_type = "ordered"</code> generates an ordered
categorical outcome (e.g., survey responses ranging from â€œstrongly
disagreeâ€ to â€œstrongly agreeâ€).</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Generate synthetic data.</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2000</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_qualitative_data_soo.html">generate_qualitative_data_soo</a></span><span class="op">(</span><span class="va">n</span>, assignment <span class="op">=</span> <span class="st">"observational"</span>, outcome_type <span class="op">=</span> <span class="st">"ordered"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">D</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">X</span></span></code></pre></div>
<p>Once the data set is generated, we use <code>causalQual_soo</code> to
estimate the PS for each outcome category. This function performs
estimation by applying the double machine learning procedures of
Chernozukov et al.Â (2018) to the binary variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">1(Y_i = m)</annotation></semantics></math>.
Specifically, for each class
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>,
we define the doubly robust scores as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î“</mi><mrow><mi>m</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>:=</mo><msub><mi>p</mi><mi>m</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><msub><mi>p</mi><mi>m</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>D</mi><mi>i</mi></msub><mfrac><mrow><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><msub><mi>p</mi><mi>m</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>Ï€</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>âˆ’</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><msub><mi>D</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mrow><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><msub><mi>p</mi><mi>m</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>âˆ’</mo><mi>Ï€</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex"> \Gamma_{m, i} := p_m (1, X_i) - p_m (0, X_i) + D_i \frac{1(Y_i = m) - p_m (1, X_i)}{\pi(X_i)} - (1 - D_i) \frac{1(Y_i = m) - p_m (0, x)}{1 - \pi(X_i)}.</annotation></semantics></math><code>causalQual_soo</code> constructs plug-in estimates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>Î“</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>m</mi><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\hat{\Gamma}_{m, i}</annotation></semantics></math>
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î“</mi><mrow><mi>m</mi><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\Gamma_{m, i}</annotation></semantics></math>
by replacing the unknown
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>m</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mo>â‹…</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_m (1, \cdot)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>m</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mo>â‹…</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_m (0, \cdot)</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï€</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>â‹…</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi(\cdot)</annotation></semantics></math>
with consistent estimates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>p</mi><mo accent="true">Ì‚</mo></mover><mi>m</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mo>â‹…</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{p}_m (1, \cdot)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>p</mi><mo accent="true">Ì‚</mo></mover><mi>m</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mo>â‹…</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{p}_m (0, \cdot)</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>Ï€</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mo>â‹…</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\pi}(\cdot)</annotation></semantics></math>
obtained via
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-fold
cross fitting, with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
selected by the users via the <code>K</code> argument.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> The estimator for PS
is then</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>Î´</mi><mo accent="true">Ì‚</mo></mover><mi>m</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mover><mi>Î“</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>m</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>,</mo></mrow><annotation encoding="application/x-tex"> \hat{\delta}_m = \frac{1}{n} \sum_{i=1}^{n} \hat{\Gamma}_{m, i}, </annotation></semantics></math>
and its variance is estimated as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mtext mathvariant="normal">Var</mtext><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>Î´</mi><mo accent="true">Ì‚</mo></mover><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>Î“</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>m</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>âˆ’</mo><msub><mover><mi>Î´</mi><mo accent="true">Ì‚</mo></mover><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mi>.</mi></mrow><annotation encoding="application/x-tex"> \widehat{\text{Var}} ( \hat{\delta}_m ) = \frac{1}{n} \sum_{i=1}^{n} ( \hat{\Gamma}_{m, i} - \hat{\delta}_m )^2.</annotation></semantics></math><code>causalQual_soo</code> uses these estimates to construct confidence
intervals using conventional normal approximations. Users can modify the
parameters to generate data sets with different sample sizes and outcome
types (â€œorderedâ€ vs.Â â€œmultinomialâ€) as before.</p>
<p>To estimate the conditional class probabilities
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>m</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo>,</mo><mo>â‹…</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.167em"></mspace><mi>d</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p_m (d, \cdot), \, d = 0, 1</annotation></semantics></math>,
<code>causalQual_soo</code> adopts multinomial machine learning
strategies when the outcome is multinomial and the honest ordered
correlation forest estimator when the outcome is ordered (Di Francesco,
2025), according to the userâ€™s choice of <code>outcome_type</code>. The
function trains separate models for treated and control units. The
propensity score
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï€</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>â‹…</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi(\cdot)</annotation></semantics></math>
is estimated via an honest regression forest (Athey et al., 2019).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="do">## Estimation.</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">causalQual_soo</span>(Y, D, X, <span class="at">outcome_type =</span> <span class="st">"ordered"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>R<span class="sc">&gt;</span> </span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>R<span class="sc">&gt;</span> â”€â”€ CAUSAL INFERENCE FOR QUALITATIVE OUTCOMES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>R<span class="sc">&gt;</span> </span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>R<span class="sc">&gt;</span> â”€â”€ Research design â”€â”€</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>R<span class="sc">&gt;</span> </span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>R<span class="sc">&gt;</span> Identification<span class="sc">:</span>          Selection<span class="sc">-</span>on<span class="sc">-</span>Observables </span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>R<span class="sc">&gt;</span> Estimand<span class="sc">:</span>                Probability Shifts </span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>R<span class="sc">&gt;</span> Outcome type<span class="sc">:</span>            ordered </span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>R<span class="sc">&gt;</span> Classes<span class="sc">:</span>                 <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> </span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>R<span class="sc">&gt;</span> N. units<span class="sc">:</span>                <span class="dv">2000</span> </span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>R<span class="sc">&gt;</span> Fraction treated units<span class="sc">:</span>  <span class="fl">0.52</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>R<span class="sc">&gt;</span> â”€â”€ Point estimates and <span class="dv">95</span>\% confidence intervals â”€â”€</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>R<span class="sc">&gt;</span> Class <span class="dv">1</span><span class="sc">:</span> <span class="sc">-</span><span class="fl">0.585</span>  [<span class="sc">-</span><span class="fl">0.624</span>, <span class="sc">-</span><span class="fl">0.547</span>]</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>R<span class="sc">&gt;</span> Class <span class="dv">2</span><span class="sc">:</span> <span class="sc">-</span><span class="fl">0.018</span>  [<span class="sc">-</span><span class="fl">0.064</span>,  <span class="fl">0.027</span>]</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>R<span class="sc">&gt;</span> Class <span class="dv">3</span><span class="sc">:</span>  <span class="fl">0.604</span>  [ <span class="fl">0.565</span>,  <span class="fl">0.642</span>]</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="instrumental-variables">Instrumental Variables<a class="anchor" aria-label="anchor" href="#instrumental-variables"></a>
</h2>
<p>In some applications, the observed covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub><annotation encoding="application/x-tex">X_i</annotation></semantics></math>
may not fully account for selection into treatment, making a
selection-on-observables design unsuitable. Instrumental variables (IV)
designs provide a popular identification strategy to address this issue.
The key idea behind IV is to exploit a variable â€“ an instrument â€“ that
is as good as randomly assigned, influences treatment assignment, but
has no direct effect on the outcome except through treatment. This
exogenous source of variation enables the identification of causal
effects by isolating changes in treatment status that are not driven by
unobserved factors.</p>
<p>Formally, IV designs rely on the following assumptions.</p>
<ul>
<li>
<strong>Assumption 3</strong> (<em>Exogeneity</em>):
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>D</mi><mi>i</mi></msub><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>D</mi><mi>i</mi></msub><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msub><mi>D</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msub><mi>D</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo><mi>âŠ¥</mi><msub><mi>Z</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\{ Y_i (D_i, 1), Y_i (D_i, 0), D_i(1), D_i(0) \} âŠ¥ Z_i</annotation></semantics></math>.</li>
<li>
<strong>Assumption 4</strong> (<em>Exclusion restriction</em>):
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.167em"></mspace><mi>d</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">Y_i(d, 1) = Y_i(d, 0) = Y_i(d), \, d = 0, 1</annotation></semantics></math>.</li>
<li>
<strong>Assumption 5</strong> (<em>Monotonicity</em>):
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>D</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>â‰¥</mo><msub><mi>D</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">P (D_i(1) \geq D_i(0))=1</annotation></semantics></math>.</li>
<li>
<strong>Assumption 6</strong> (<em>Relevance</em>):
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><mi>c</mi><mi>o</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">P(T_i=co) &gt; 0</annotation></semantics></math>.</li>
</ul>
<p>Assumption 3 mandates that the instrument is as good as randomly
assigned. Assumption 4 requires that the instrument affects the outcome
only through its influence on treatment, ruling out any direct effect.
Assumption 5 imposes that the instrument can only increase the
likelihood of treatment, ruling out defiers.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> Finally, Assumption 6
states that the instrument has a nonzero effect on the treatment,
thereby generating exogenous variation in the latter.</p>
<p>Together, these assumptions enable the identification of the Local
Probability of Shift (LPS), defined as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î´</mi><mrow><mi>m</mi><mo>,</mo><mi>L</mi></mrow></msub><mo>:=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>m</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><mi>c</mi><mi>o</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>m</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><mi>c</mi><mi>o</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> \delta_{m, L} := P ( Y_i (1) = m | T_i = co ) - P ( Y_i (0) = m | T_i = co).</annotation></semantics></math>
LPS provides the same characterization as the PS while focusing on the
complier subpopulation.</p>
<p>For illustration, we generate a synthetic data set using the
<code>generate_qualitative_data_iv</code> function. Users can modify the
parameters to generate data sets with different sample sizes and outcome
types (multinomial or ordered) as before, although
<code>generate_qualitative_data_iv</code> does not allow to modify the
treatment assignment mechanism.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Generate synthetic data.</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2000</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_qualitative_data_iv.html">generate_qualitative_data_iv</a></span><span class="op">(</span><span class="va">n</span>, outcome_type <span class="op">=</span> <span class="st">"ordered"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">D</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">Z</span></span></code></pre></div>
<p>Once the data set is generated, we use <code>causalQual_iv</code> to
estimate the LPS for each outcome category. This function performs
estimation by applying the standard two-stage least squares method to
the binary variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">1(Y_i = m)</annotation></semantics></math>.
Specifically, we first estimate the following first-stage regression
model via OLS:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>i</mi></msub><mo>=</mo><msub><mi>Î³</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Î³</mi><mn>1</mn></msub><msub><mi>Z</mi><mi>i</mi></msub><mo>+</mo><msub><mi>Î½</mi><mi>i</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex"> D_i = \gamma_0 + \gamma_1 Z_i + \nu_i,</annotation></semantics></math></p>
<p>and construct the predicted values
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>D</mi><mo accent="true">Ì‚</mo></mover><mi>i</mi></msub><annotation encoding="application/x-tex">\widehat{D}_i</annotation></semantics></math>.
We then use these predicted values in the second-stage regressions:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Î±</mi><mrow><mi>m</mi><mn>0</mn></mrow></msub><mo>+</mo><msub><mi>Î±</mi><mrow><mi>m</mi><mn>1</mn></mrow></msub><msub><mover><mi>D</mi><mo accent="true">Ì‚</mo></mover><mi>i</mi></msub><mo>+</mo><msub><mi>Ïµ</mi><mrow><mi>m</mi><mi>i</mi></mrow></msub><mo>,</mo><mspace width="1.0em"></mspace><mi>m</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mi>M</mi><mi>.</mi></mrow><annotation encoding="application/x-tex"> 1(Y_i = m) = \alpha_{m0} + \alpha_{m1} \widehat{D}_i + \epsilon_{mi}, \quad m = 1, \dots M.</annotation></semantics></math></p>
<p>A well-established result in the IV literature is that, under
Assumptions 3-5,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mrow><mi>m</mi><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>Î´</mi><mrow><mi>m</mi><mo>,</mo><mi>L</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\alpha_{m1} = \delta_{m, L}</annotation></semantics></math>
(Imbens and Angrist, 1994; Angrist et al., 1996). Therefore, we estimate
the second-stage regression models via OLS and use the resulting
estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>Î±</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>m</mi><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\hat{\alpha}_{m1}</annotation></semantics></math>
as an estimate of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î´</mi><mrow><mi>m</mi><mo>,</mo><mi>L</mi></mrow></msub><annotation encoding="application/x-tex">\delta_{m, L}</annotation></semantics></math>.
Standard errors are computed using standard procedures and used to
construct conventional confidence intervals.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="do">## Estimation.</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">causalQual_iv</span>(Y, D, Z)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>R<span class="sc">&gt;</span> â”€â”€ CAUSAL INFERENCE FOR QUALITATIVE OUTCOMES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>R<span class="sc">&gt;</span> </span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>R<span class="sc">&gt;</span> â”€â”€ Research design â”€â”€</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>R<span class="sc">&gt;</span> </span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>R<span class="sc">&gt;</span> Identification<span class="sc">:</span>          Instrumental Variables </span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>R<span class="sc">&gt;</span> Estimand<span class="sc">:</span>                Local Probability Shifts </span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>R<span class="sc">&gt;</span> Outcome type<span class="sc">:</span>            </span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>R<span class="sc">&gt;</span> Classes<span class="sc">:</span>                 <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> </span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>R<span class="sc">&gt;</span> N. units<span class="sc">:</span>                <span class="dv">2000</span> </span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>R<span class="sc">&gt;</span> Fraction treated units<span class="sc">:</span>  <span class="fl">0.514</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>R<span class="sc">&gt;</span> â”€â”€ Point estimates and <span class="dv">95</span>\% confidence intervals â”€â”€</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>R<span class="sc">&gt;</span> Class <span class="dv">1</span><span class="sc">:</span> <span class="sc">-</span><span class="fl">0.632</span>  [<span class="sc">-</span><span class="fl">0.730</span>, <span class="sc">-</span><span class="fl">0.533</span>]</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>R<span class="sc">&gt;</span> Class <span class="dv">2</span><span class="sc">:</span>  <span class="fl">0.037</span>  [<span class="sc">-</span><span class="fl">0.072</span>,  <span class="fl">0.146</span>]</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>R<span class="sc">&gt;</span> Class <span class="dv">3</span><span class="sc">:</span>  <span class="fl">0.594</span>  [ <span class="fl">0.495</span>,  <span class="fl">0.694</span>]</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="regression-discontinuity">Regression Discontinuity<a class="anchor" aria-label="anchor" href="#regression-discontinuity"></a>
</h2>
<p>Regression Discontinuity designs are employed to identify causal
effects when treatment assignment is determined by whether a continuous
variable crosses a known threshold or cutoff. The key assumption is that
units just above and just below the cutoff are comparable, meaning that
any discontinuity in outcomes at the threshold can be attributed to the
treatment rather than to pre-existing differences.</p>
<p>In this section, we let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub><annotation encoding="application/x-tex">X_i</annotation></semantics></math>
be a single observed covariate (rather than a vector of covariates) and
we call it running variable.â€ By construction,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub><annotation encoding="application/x-tex">X_i</annotation></semantics></math>
fully determines treatment assignment. Specifically, units receive
treatment if and only if their running variable exceeds a predetermined
threshold
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>.
Thus,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>â‰¥</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">D_i = 1(X_i \geq c)</annotation></semantics></math>.</p>
<p>By construction, Assumption 1 above is satisfied since conditioning
on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub><annotation encoding="application/x-tex">X_i</annotation></semantics></math>
fully determines
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mi>i</mi></msub><annotation encoding="application/x-tex">D_i</annotation></semantics></math>.
For our identification purporses, we introduce an additional
assumption.</p>
<ul>
<li>
<strong>Assumption 7</strong> (<em>Continuity</em>):
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>m</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>i</mi></msub><mo>=</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P( Y_i(d) = m | X_i = x )</annotation></semantics></math>
is continuous in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">d = 0, 1</annotation></semantics></math>.</li>
</ul>
<p>Assumption 7 requires that the conditional probability mass functions
of potential outcomes evolve smoothly with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>.
This ensures that class probabilities remain comparable in a
neighborhood of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>.</p>
<p>Assumptions 1 and 7 enable the identification of the Probability of
Shift at the Cutoff (PSC) for class
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>,
defined as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î´</mi><mrow><mi>m</mi><mo>,</mo><mi>C</mi></mrow></msub><mo>:=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>m</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>i</mi></msub><mo>=</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>m</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>i</mi></msub><mo>=</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> \delta_{m, C} := P ( Y_i (1) = m | X_i = c ) - P ( Y_i (0) = m | X_i = c).</annotation></semantics></math></p>
<p>PSC provides the same characterization as the PS while focusing on
the subpopulation of units whose running variable values are â€œcloseâ€ to
the cutoff
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>.</p>
<p>For illustration, we generate a synthetic data set using the
<code>generate_qualitative_data_rd</code> function. Users can modify the
parameters to generate data sets with different sample sizes and outcome
types (multinomial or ordered) as before, although
<code>generate_qualitative_data_rd</code> does not allow to modify the
treatment assignment mechanism.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Generate synthetic data.</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2000</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_qualitative_data_rd.html">generate_qualitative_data_rd</a></span><span class="op">(</span><span class="va">n</span>, outcome_type <span class="op">=</span> <span class="st">"ordered"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">running_variable</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">running_variable</span></span>
<span><span class="va">cutoff</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">cutoff</span></span></code></pre></div>
<p>Once the data set is generated, we use <code>causalQual_rd</code> to
estimate the PSC for each outcome category. This function performs
estimation using standard local polynomial estimators applied to to the
binary variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">1(Y_i = m)</annotation></semantics></math>.
Specifically, <code>causalQual_rd</code> implements the robust
bias-corrected inference procedure of Calonico et al.Â (2014).<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="do">## Estimation.</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">causalQual_rd</span>(Y, running_variable, cutoff)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>R<span class="sc">&gt;</span> â”€â”€ CAUSAL INFERENCE FOR QUALITATIVE OUTCOMES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>R<span class="sc">&gt;</span> </span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>R<span class="sc">&gt;</span> â”€â”€ Research design â”€â”€</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>R<span class="sc">&gt;</span> </span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>R<span class="sc">&gt;</span> Identification<span class="sc">:</span>          Regression Discontinuity </span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>R<span class="sc">&gt;</span> Estimand<span class="sc">:</span>                Probability Shifts at the Cutoff </span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>R<span class="sc">&gt;</span> Outcome type<span class="sc">:</span>            </span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>R<span class="sc">&gt;</span> Classes<span class="sc">:</span>                 <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> </span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>R<span class="sc">&gt;</span> N. units<span class="sc">:</span>                <span class="dv">2000</span> </span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>R<span class="sc">&gt;</span> Fraction treated units<span class="sc">:</span>  <span class="fl">0.5065</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>R<span class="sc">&gt;</span> â”€â”€ Point estimates and <span class="dv">95</span>\% confidence intervals â”€â”€</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>R<span class="sc">&gt;</span> Class <span class="dv">1</span><span class="sc">:</span> <span class="sc">-</span><span class="fl">0.646</span>  [<span class="sc">-</span><span class="fl">0.791</span>, <span class="sc">-</span><span class="fl">0.502</span>]</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>R<span class="sc">&gt;</span> Class <span class="dv">2</span><span class="sc">:</span>  <span class="fl">0.086</span>  [<span class="sc">-</span><span class="fl">0.067</span>,  <span class="fl">0.239</span>]</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>R<span class="sc">&gt;</span> Class <span class="dv">3</span><span class="sc">:</span>  <span class="fl">0.549</span>  [ <span class="fl">0.392</span>,  <span class="fl">0.706</span>]</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="difference-in-differences">Difference-in-Differences<a class="anchor" aria-label="anchor" href="#difference-in-differences"></a>
</h2>
<p>Difference-in-Differences designs are employed to identify causal
effects when units are observed over time and treatment is introduced
only from a certain point onward for some units. The key assumption is
that, in the absence of treatment, the change in outcomes for treated
units would have mirrored the change observed in the control group.</p>
<p>For our identification purporses, we introduce the following
assumption.</p>
<ul>
<li>
<strong>Assumption 8</strong> (<em>Parallel trends</em>): <span class="math inline">$P ( Y_{it} (0) = m | D_i = 1) - P ( Y_{it-1} (0) =
m | D_i = 1 ) = P ( Y_{it} (0) = m | D_i = 0) - \PX ( Y_{it-1} (0) = m |
D_i = 0 )$</span>.</li>
</ul>
<p>Assumption 8 requires that the probability time shift of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>s</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y_{is} (0)</annotation></semantics></math>
for class
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
follows a similar evolution over time in both the treated and control
groups.</p>
<p>Assumptions 8 enables the identification of the Probability of Shift
on the Treated (PST) for class
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>,
defined as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î´</mi><mrow><mi>m</mi><mo>,</mo><mi>T</mi></mrow></msub><mo>:=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>m</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>D</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>t</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>m</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>D</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> \delta_{m, T} := P ( Y_{it} (1) = m | D_i = 1 ) - P ( Y_{it} (0) = m | D_i = 1).</annotation></semantics></math></p>
<p>PSt provides the same characterization as the PS while focusing on
the subpopulation of treated units.</p>
<p>For illustration, we generate a synthetic data set using the
<code>generate_qualitative_data_did</code> function. As before, users
can modify the parameters to generate data sets with different sample
sizes, treatment assignment mechanisms (randomized vs.Â observational),
and outcome types (multinomial or ordered).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2000</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_qualitative_data_did.html">generate_qualitative_data_did</a></span><span class="op">(</span><span class="va">n</span>, assignment <span class="op">=</span> <span class="st">"observational"</span>, outcome_type <span class="op">=</span> <span class="st">"ordered"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Y_pre</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">Y_pre</span></span>
<span><span class="va">Y_post</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">Y_post</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">D</span></span></code></pre></div>
<p>Once the data set is generated, we use <code>causalQual_did</code> to
estimate the PST for each outcome category. This function performs
estimation by applying the canonical two-group/two-period DiD method to
the binary variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">1(Y_i = m)</annotation></semantics></math>.
Specifically, consider the following linear regression model:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mi>s</mi><mo>=</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>D</mi><mi>i</mi></msub><msub><mi>Î²</mi><mrow><mi>m</mi><mn>1</mn></mrow></msub><mo>+</mo><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo>=</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>Î²</mi><mrow><mi>m</mi><mn>2</mn></mrow></msub><mo>+</mo><msub><mi>D</mi><mi>i</mi></msub><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo>=</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>Î²</mi><mrow><mi>m</mi><mn>3</mn></mrow></msub><mo>+</mo><msub><mi>Ïµ</mi><mrow><mi>m</mi><mi>i</mi><mi>s</mi></mrow></msub><mi>.</mi></mrow><annotation encoding="application/x-tex"> 1 (Y_is = m) = D_i \beta_{m1} + 1(s = t) \beta_{m2} + D_i 1(s = t) \beta_{m3} + \epsilon_{mis}.</annotation></semantics></math></p>
<p>A well-established result in the DiD literature is that, under
Assumption 8,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î²</mi><mrow><mi>m</mi><mn>3</mn></mrow></msub><mo>=</mo><msub><mi>Î´</mi><mrow><mi>m</mi><mo>,</mo><mi>T</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\beta_{m3} = \delta_{m, T}</annotation></semantics></math>.
Therefore, we estimate the above model via OLS and use the resulting
estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>Î²</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>m</mi><mn>3</mn></mrow></msub><annotation encoding="application/x-tex">\hat{\beta}_{m3}</annotation></semantics></math>
as an estimate of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î´</mi><mrow><mi>m</mi><mo>,</mo><mi>T</mi></mrow></msub><annotation encoding="application/x-tex">\delta_{m, T}</annotation></semantics></math>.
Standard errors are clustered at the unit level and used to construct
conventional confidence intervals.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">causalQual_did</span>(Y_pre, Y_post, D)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>R<span class="sc">&gt;</span> â”€â”€ CAUSAL INFERENCE FOR QUALITATIVE OUTCOMES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>R<span class="sc">&gt;</span> </span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>R<span class="sc">&gt;</span> â”€â”€ Research design â”€â”€</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>R<span class="sc">&gt;</span> </span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>R<span class="sc">&gt;</span> Identification<span class="sc">:</span>          Difference<span class="sc">-</span><span class="cf">in</span><span class="sc">-</span>Differences </span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>R<span class="sc">&gt;</span> Estimand<span class="sc">:</span>                Probability Shifts on the Treated </span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>R<span class="sc">&gt;</span> Outcome type<span class="sc">:</span>            </span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>R<span class="sc">&gt;</span> Classes<span class="sc">:</span>                 <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> </span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>R<span class="sc">&gt;</span> N. units<span class="sc">:</span>                <span class="dv">2000</span> </span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>R<span class="sc">&gt;</span> Fraction treated units<span class="sc">:</span>  <span class="fl">0.4975</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>R<span class="sc">&gt;</span> â”€â”€ Point estimates and <span class="dv">95</span>\% confidence intervals â”€â”€</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>R<span class="sc">&gt;</span> Class <span class="dv">1</span><span class="sc">:</span> <span class="sc">-</span><span class="fl">0.571</span>  [<span class="sc">-</span><span class="fl">0.620</span>, <span class="sc">-</span><span class="fl">0.521</span>]</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>R<span class="sc">&gt;</span> Class <span class="dv">2</span><span class="sc">:</span> <span class="sc">-</span><span class="fl">0.063</span>  [<span class="sc">-</span><span class="fl">0.114</span>, <span class="sc">-</span><span class="fl">0.011</span>]</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>R<span class="sc">&gt;</span> Class <span class="dv">3</span><span class="sc">:</span>  <span class="fl">0.633</span>  [ <span class="fl">0.595</span>,  <span class="fl">0.671</span>]</span></code></pre></div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>A potential issue in estimation arises if, after
splitting the sample into folds and each fold into treated and control
groups, at least one class of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_i</annotation></semantics></math>
is unobserved within a given fold for a specific treatment group. To
mitigate this issue, <code>causalQual_soo</code> repeatedly splits the
data until all outcome categories are present in each fold and treatment
group.<a href="#fnref1" class="footnote-back">â†©ï¸</a></p></li>
<li id="fn2"><p>This assumption is made without loss of generality; one
could alternatively assume that the instrument can only decrease the
probability of treatment.<a href="#fnref2" class="footnote-back">â†©ï¸</a></p></li>
<li id="fn3"><p><code>causalQual_iv</code> implements this two-stage
least squares procedure by calling the <code>ivreg</code> function from
the R package <code>AER</code>.<a href="#fnref3" class="footnote-back">â†©ï¸</a></p></li>
<li id="fn4"><p><code>causalQual_rd</code> implements these
methodologies by calling the <code>rdrobust</code> function from the R
package <code>rdrobust</code> (Calonico et al., 2015).<a href="#fnref4" class="footnote-back">â†©ï¸</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Riccardo Di Francesco.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
